<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>regexp/no-super-linear-move | eslint-plugin-regexp</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="disallow quantifiers that cause quadratic moves">
    
    <link rel="preload" href="/eslint-plugin-regexp/assets/css/0.styles.b44117cd.css" as="style"><link rel="preload" href="/eslint-plugin-regexp/assets/js/app.53bb6b9c.js" as="script"><link rel="preload" href="/eslint-plugin-regexp/assets/js/7.099bdba0.js" as="script"><link rel="preload" href="/eslint-plugin-regexp/assets/js/47.8b960cb8.js" as="script"><link rel="preload" href="/eslint-plugin-regexp/assets/js/10.252a16cb.js" as="script"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/1.1184e0bc.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/100.798d2c3f.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/11.11dc044a.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/12.92de53a8.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/13.587b969a.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/14.2f6b5836.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/15.af8674d1.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/16.73ef0d07.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/17.483a27b0.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/18.ef8f246a.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/19.dfdcef90.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/2.536f168f.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/20.502b5b45.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/21.7b381877.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/22.f52e2ecb.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/23.ffefb481.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/24.45aa7b9e.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/25.1b5f4cf7.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/26.9a253666.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/27.22e5fdfd.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/28.afa7e5a6.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/29.6a793d5b.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/3.ed32cf3d.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/30.baac0b30.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/31.d8119003.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/32.89283ffd.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/33.0d86560e.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/34.864b1989.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/35.13d03a1b.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/36.b23cb6a7.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/37.8dccb9b3.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/38.0ce8aa6e.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/39.cfa95227.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/40.e94b33d0.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/41.2f908c0f.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/42.b9dbbf2d.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/43.1e0a0156.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/44.345c8f63.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/45.7c875dce.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/46.8cf3f420.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/48.193cf765.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/49.289b5e97.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/5.3ae7a3d6.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/50.10061736.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/51.88085247.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/52.1951e3c5.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/53.41a1daa1.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/54.acc015af.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/55.978dd648.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/56.cd3b832f.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/57.9fe617c2.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/58.e87e9472.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/59.8f79fab8.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/6.bec5083c.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/60.22475168.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/61.b1daf66b.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/62.b62bd789.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/63.8b654802.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/64.e5860019.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/65.0d434bde.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/66.2b577016.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/67.c4f9a79f.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/68.621a7aab.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/69.a95b0ae3.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/70.13683317.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/71.5a1fe2ea.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/72.efb138b9.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/73.7cda06e0.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/74.3fa4e1ac.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/75.8799e60b.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/76.e8611c19.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/77.bc3dfa04.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/78.05060c58.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/79.47cbd8b9.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/8.a0e45dd7.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/80.95edf2da.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/81.94922db2.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/82.d05eb343.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/83.b3764373.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/84.13ee6530.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/85.a3844ac9.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/86.d5c81ac9.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/87.d8375825.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/88.879e9310.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/89.33662413.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/9.82cec4b6.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/90.2b3a2ff0.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/91.d06effff.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/92.1c89d0b1.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/93.bca4492b.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/94.5e317c16.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/95.a734125e.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/96.9bc4482c.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/97.a5eb4210.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/98.dc354b6c.js"><link rel="prefetch" href="/eslint-plugin-regexp/assets/js/99.db9ec511.js">
    <link rel="stylesheet" href="/eslint-plugin-regexp/assets/css/0.styles.b44117cd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container rule-details"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/eslint-plugin-regexp/" class="home-link router-link-active"><!----> <span class="site-name">eslint-plugin-regexp</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/eslint-plugin-regexp/" class="nav-link">
  Introduction
</a></div><div class="nav-item"><a href="/eslint-plugin-regexp/user-guide/" class="nav-link">
  User Guide
</a></div><div class="nav-item"><a href="/eslint-plugin-regexp/rules/" class="nav-link router-link-active">
  Rules
</a></div><div class="nav-item"><a href="/eslint-plugin-regexp/settings/" class="nav-link">
  Settings
</a></div><div class="nav-item"><a href="/eslint-plugin-regexp/playground/" class="nav-link">
  Playground
</a></div> <a href="https://github.com/ota-meshi/eslint-plugin-regexp" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/eslint-plugin-regexp/" class="nav-link">
  Introduction
</a></div><div class="nav-item"><a href="/eslint-plugin-regexp/user-guide/" class="nav-link">
  User Guide
</a></div><div class="nav-item"><a href="/eslint-plugin-regexp/rules/" class="nav-link router-link-active">
  Rules
</a></div><div class="nav-item"><a href="/eslint-plugin-regexp/settings/" class="nav-link">
  Settings
</a></div><div class="nav-item"><a href="/eslint-plugin-regexp/playground/" class="nav-link">
  Playground
</a></div> <a href="https://github.com/ota-meshi/eslint-plugin-regexp" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/eslint-plugin-regexp/rules/" aria-current="page" class="sidebar-link">Available Rules</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Possible Errors</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/eslint-plugin-regexp/rules/no-assertion-capturing-group.html" class="sidebar-link">regexp/no-assertion-capturing-group</a></li><li><a href="/eslint-plugin-regexp/rules/no-dupe-disjunctions.html" class="sidebar-link">regexp/no-dupe-disjunctions</a></li><li><a href="/eslint-plugin-regexp/rules/no-empty-alternative.html" class="sidebar-link">regexp/no-empty-alternative</a></li><li><a href="/eslint-plugin-regexp/rules/no-empty-capturing-group.html" class="sidebar-link">regexp/no-empty-capturing-group</a></li><li><a href="/eslint-plugin-regexp/rules/no-empty-group.html" class="sidebar-link">regexp/no-empty-group</a></li><li><a href="/eslint-plugin-regexp/rules/no-empty-lookarounds-assertion.html" class="sidebar-link">regexp/no-empty-lookarounds-assertion</a></li><li><a href="/eslint-plugin-regexp/rules/no-escape-backspace.html" class="sidebar-link">regexp/no-escape-backspace</a></li><li><a href="/eslint-plugin-regexp/rules/no-lazy-ends.html" class="sidebar-link">regexp/no-lazy-ends</a></li><li><a href="/eslint-plugin-regexp/rules/no-optional-assertion.html" class="sidebar-link">regexp/no-optional-assertion</a></li><li><a href="/eslint-plugin-regexp/rules/no-potentially-useless-backreference.html" class="sidebar-link">regexp/no-potentially-useless-backreference</a></li><li><a href="/eslint-plugin-regexp/rules/no-super-linear-backtracking.html" class="sidebar-link">regexp/no-super-linear-backtracking</a></li><li><a href="/eslint-plugin-regexp/rules/no-super-linear-move.html" aria-current="page" class="active sidebar-link">regexp/no-super-linear-move</a></li><li><a href="/eslint-plugin-regexp/rules/no-useless-assertions.html" class="sidebar-link">regexp/no-useless-assertions</a></li><li><a href="/eslint-plugin-regexp/rules/no-useless-backreference.html" class="sidebar-link">regexp/no-useless-backreference</a></li><li><a href="/eslint-plugin-regexp/rules/no-useless-dollar-replacements.html" class="sidebar-link">regexp/no-useless-dollar-replacements</a></li><li><a href="/eslint-plugin-regexp/rules/strict.html" class="sidebar-link">regexp/strict</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Best Practices</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/eslint-plugin-regexp/rules/confusing-quantifier.html" class="sidebar-link">regexp/confusing-quantifier</a></li><li><a href="/eslint-plugin-regexp/rules/control-character-escape.html" class="sidebar-link">regexp/control-character-escape</a></li><li><a href="/eslint-plugin-regexp/rules/negation.html" class="sidebar-link">regexp/negation</a></li><li><a href="/eslint-plugin-regexp/rules/no-dupe-characters-character-class.html" class="sidebar-link">regexp/no-dupe-characters-character-class</a></li><li><a href="/eslint-plugin-regexp/rules/no-invisible-character.html" class="sidebar-link">regexp/no-invisible-character</a></li><li><a href="/eslint-plugin-regexp/rules/no-legacy-features.html" class="sidebar-link">regexp/no-legacy-features</a></li><li><a href="/eslint-plugin-regexp/rules/no-non-standard-flag.html" class="sidebar-link">regexp/no-non-standard-flag</a></li><li><a href="/eslint-plugin-regexp/rules/no-obscure-range.html" class="sidebar-link">regexp/no-obscure-range</a></li><li><a href="/eslint-plugin-regexp/rules/no-octal.html" class="sidebar-link">regexp/no-octal</a></li><li><a href="/eslint-plugin-regexp/rules/no-standalone-backslash.html" class="sidebar-link">regexp/no-standalone-backslash</a></li><li><a href="/eslint-plugin-regexp/rules/no-trivially-nested-assertion.html" class="sidebar-link">regexp/no-trivially-nested-assertion</a></li><li><a href="/eslint-plugin-regexp/rules/no-trivially-nested-quantifier.html" class="sidebar-link">regexp/no-trivially-nested-quantifier</a></li><li><a href="/eslint-plugin-regexp/rules/no-unused-capturing-group.html" class="sidebar-link">regexp/no-unused-capturing-group</a></li><li><a href="/eslint-plugin-regexp/rules/no-useless-character-class.html" class="sidebar-link">regexp/no-useless-character-class</a></li><li><a href="/eslint-plugin-regexp/rules/no-useless-exactly-quantifier.html" class="sidebar-link">regexp/no-useless-exactly-quantifier</a></li><li><a href="/eslint-plugin-regexp/rules/no-useless-flag.html" class="sidebar-link">regexp/no-useless-flag</a></li><li><a href="/eslint-plugin-regexp/rules/no-useless-lazy.html" class="sidebar-link">regexp/no-useless-lazy</a></li><li><a href="/eslint-plugin-regexp/rules/no-useless-non-greedy.html" class="sidebar-link">regexp/no-useless-non-greedy</a></li><li><a href="/eslint-plugin-regexp/rules/no-useless-quantifier.html" class="sidebar-link">regexp/no-useless-quantifier</a></li><li><a href="/eslint-plugin-regexp/rules/no-useless-range.html" class="sidebar-link">regexp/no-useless-range</a></li><li><a href="/eslint-plugin-regexp/rules/no-useless-two-nums-quantifier.html" class="sidebar-link">regexp/no-useless-two-nums-quantifier</a></li><li><a href="/eslint-plugin-regexp/rules/no-zero-quantifier.html" class="sidebar-link">regexp/no-zero-quantifier</a></li><li><a href="/eslint-plugin-regexp/rules/optimal-lookaround-quantifier.html" class="sidebar-link">regexp/optimal-lookaround-quantifier</a></li><li><a href="/eslint-plugin-regexp/rules/optimal-quantifier-concatenation.html" class="sidebar-link">regexp/optimal-quantifier-concatenation</a></li><li><a href="/eslint-plugin-regexp/rules/prefer-escape-replacement-dollar-char.html" class="sidebar-link">regexp/prefer-escape-replacement-dollar-char</a></li><li><a href="/eslint-plugin-regexp/rules/prefer-predefined-assertion.html" class="sidebar-link">regexp/prefer-predefined-assertion</a></li><li><a href="/eslint-plugin-regexp/rules/prefer-quantifier.html" class="sidebar-link">regexp/prefer-quantifier</a></li><li><a href="/eslint-plugin-regexp/rules/prefer-range.html" class="sidebar-link">regexp/prefer-range</a></li><li><a href="/eslint-plugin-regexp/rules/prefer-regexp-exec.html" class="sidebar-link">regexp/prefer-regexp-exec</a></li><li><a href="/eslint-plugin-regexp/rules/prefer-regexp-test.html" class="sidebar-link">regexp/prefer-regexp-test</a></li><li><a href="/eslint-plugin-regexp/rules/sort-alternatives.html" class="sidebar-link">regexp/sort-alternatives</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Stylistic Issues</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/eslint-plugin-regexp/rules/hexadecimal-escape.html" class="sidebar-link">regexp/hexadecimal-escape</a></li><li><a href="/eslint-plugin-regexp/rules/letter-case.html" class="sidebar-link">regexp/letter-case</a></li><li><a href="/eslint-plugin-regexp/rules/match-any.html" class="sidebar-link">regexp/match-any</a></li><li><a href="/eslint-plugin-regexp/rules/no-useless-escape.html" class="sidebar-link">regexp/no-useless-escape</a></li><li><a href="/eslint-plugin-regexp/rules/no-useless-non-capturing-group.html" class="sidebar-link">regexp/no-useless-non-capturing-group</a></li><li><a href="/eslint-plugin-regexp/rules/order-in-character-class.html" class="sidebar-link">regexp/order-in-character-class</a></li><li><a href="/eslint-plugin-regexp/rules/prefer-character-class.html" class="sidebar-link">regexp/prefer-character-class</a></li><li><a href="/eslint-plugin-regexp/rules/prefer-d.html" class="sidebar-link">regexp/prefer-d</a></li><li><a href="/eslint-plugin-regexp/rules/prefer-named-backreference.html" class="sidebar-link">regexp/prefer-named-backreference</a></li><li><a href="/eslint-plugin-regexp/rules/prefer-plus-quantifier.html" class="sidebar-link">regexp/prefer-plus-quantifier</a></li><li><a href="/eslint-plugin-regexp/rules/prefer-question-quantifier.html" class="sidebar-link">regexp/prefer-question-quantifier</a></li><li><a href="/eslint-plugin-regexp/rules/prefer-star-quantifier.html" class="sidebar-link">regexp/prefer-star-quantifier</a></li><li><a href="/eslint-plugin-regexp/rules/prefer-t.html" class="sidebar-link">regexp/prefer-t</a></li><li><a href="/eslint-plugin-regexp/rules/prefer-unicode-codepoint-escapes.html" class="sidebar-link">regexp/prefer-unicode-codepoint-escapes</a></li><li><a href="/eslint-plugin-regexp/rules/prefer-w.html" class="sidebar-link">regexp/prefer-w</a></li><li><a href="/eslint-plugin-regexp/rules/sort-character-class-elements.html" class="sidebar-link">regexp/sort-character-class-elements</a></li><li><a href="/eslint-plugin-regexp/rules/sort-flags.html" class="sidebar-link">regexp/sort-flags</a></li><li><a href="/eslint-plugin-regexp/rules/unicode-escape.html" class="sidebar-link">regexp/unicode-escape</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="regexp-no-super-linear-move"><a href="#regexp-no-super-linear-move" class="header-anchor">#</a> regexp/no-super-linear-move</h1> <blockquote><p>disallow quantifiers that cause quadratic moves</p></blockquote> <h2 id="rule-details"><a href="#rule-details" class="header-anchor">#</a> 📖 Rule Details</h2> <p>This rule reports super-linear worst-case runtime caused by a regex being moved across the input string. The reported cases are a problem because the super-linear worst-case runtime can be exploited by attackers in what is called <a href="https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS" target="_blank" rel="noopener noreferrer">Regular expression Denial of Service - ReDoS<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <div class="eslint-editor-root eslint-code-block eslint-editor-dark" style="height:;" data-v-0bd0b1ae><div class="eslint-editor-swap-container"><code class="eslint-editor-placeholder-code"></code> <div class="eslint-editor-placeholder-loading"><div class="eslint-editor-placeholder-loading-icon"><div></div> <div></div> <div></div></div> <div class="eslint-editor-placeholder-loading-message">
                        Now loading...
                    </div></div></div></div> <h3 id="background"><a href="#background" class="header-anchor">#</a> Background</h3> <p>Regexes are often used to find text of within a string (e.g. <code>/abc/.exec(&quot;123 abc def&quot;)</code>). The position of the matching text is unknown and has to be determined by the regex engine. In practice, the regex engine will move the regex across the input string character by character. While there are many optimizations to skip parts of the input string, there will still be <em>O(n)</em> possible positions. If there is no text matching the regex in the input string, then all <em>O(n)</em> positions will be checked.</p> <p>This is not problem in it self, <em>O(n)</em> is expected for linear string searching algorithms.</p> <p>Problems arise when the regex itself takes more than <em>O(1)</em> steps (on average) to reject any position within the input.</p> <p>Example: The regex <code>/^a+b/</code> takes <em>O(n)</em> steps to find no match in an input of <em>n</em>-many <code>a</code>s. However, the regex <code>/a+b/</code> (no assertion) takes <em>O(n)</em> steps to find no match in the same input at position 0. It will take another <em>O(n-1)</em> steps at position 1, another <em>O(n-2)</em> steps at position 2, and so on. In total, <code>/a+b/</code> will take <em>O(n^2)</em> steps to find no match in an input of <em>n</em>-many <code>a</code>s.</p> <p>If a regex is moved across the string and takes <em>O(n)</em> steps (on average) to reject each of the <em>O(n)</em> possible positions, then it will reject the input string in <em>O(n^2)</em> steps.</p> <h3 id="possible-fixes"><a href="#possible-fixes" class="header-anchor">#</a> Possible fixes</h3> <p>There are multiple ways to fix this kind of super-linear runtime.</p> <p>However, there is no one-site-fits-all solution. Adequate testing and code review are necessary to ensure that the fixed regex is still correct.</p> <h4 id="change-the-quantifier"><a href="#change-the-quantifier" class="header-anchor">#</a> Change the quantifier</h4> <p>If the quantifier is preceded by an assertion, the quantifier might be too broad (= accept too many characters). Narrowing down the quantifier might fix the issue.</p> <p>Example: <code>/^\s*(\w+)\s*[:=]/m</code></p> <p>This is a simple regex to find keys in a config file. Keys must be at the start of a line and may be surrounded by whitespace characters.</p> <p>This rule says that the first <code>\s*</code> causes quadratic runtime for &quot;any attack string <code>/[\n\r\u2028\u2029]+/</code>.&quot;</p> <p>The problem with <code>\s*</code> is that <code>\s</code> also allows line break characters (the characters in the attack string). <code>^</code> already ensures the &quot;start of a line&quot; requirement, so there is no reason to allow line breaks after the <code>^</code>.</p> <p>The fix is to remove all line break characters from <code>\s</code>. This is difficult, so let's cheat a little and say that only spaces and tabs (<code>[\t ]</code>) are allows to surround the key.</p> <div class="eslint-editor-root eslint-code-block eslint-editor-dark" style="height:;" data-v-0bd0b1ae><div class="eslint-editor-swap-container"><code class="eslint-editor-placeholder-code"></code> <div class="eslint-editor-placeholder-loading"><div class="eslint-editor-placeholder-loading-icon"><div></div> <div></div> <div></div></div> <div class="eslint-editor-placeholder-loading-message">
                        Now loading...
                    </div></div></div></div> <h4 id="limit-the-quantifier"><a href="#limit-the-quantifier" class="header-anchor">#</a> Limit the quantifier</h4> <p>All quantifiers reported by this rule are unbound (= maximum is infinite). This is because attackers need strings with a lengths &gt;1000 character to exploit the quadratic runtime.</p> <p>If the quantifier simply stops searching after some maximum number of steps, the quantifier isn't exploitable.</p> <p>Note: The maximum of the quantifier should be reasonably small (typically &lt;100). Choosing a large maximum (&gt;1000) will cause the quantifier to be exploitable despite the limit.</p> <p>Example: <code>/((?:\\{2})*)(\\?)\|/g</code></p> <p>This regex <strong>was</strong> used by <a href="https://github.com/isaacs/minimatch" target="_blank" rel="noopener noreferrer"><code>minimatch</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to find escaped and unescaped <code>|</code> characters.</p> <p>This rule says that the <code>(?:\\{2})*</code> causes quadratic runtime for &quot;any attack string <code>/(?:\\{2})+/</code>.&quot;</p> <p>The fix is to limit the <code>(?:\\{2})*</code> quantifier. <code>minimatch</code> limited it to at most 64 repetitions. You read more about this vulnerability <a href="https://medium.com/node-security/minimatch-redos-vulnerability-590da24e6d3c" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <div class="eslint-editor-root eslint-code-block eslint-editor-dark" style="height:;" data-v-0bd0b1ae><div class="eslint-editor-swap-container"><code class="eslint-editor-placeholder-code"></code> <div class="eslint-editor-placeholder-loading"><div class="eslint-editor-placeholder-loading-icon"><div></div> <div></div> <div></div></div> <div class="eslint-editor-placeholder-loading-message">
                        Now loading...
                    </div></div></div></div> <h4 id="add-an-assertion"><a href="#add-an-assertion" class="header-anchor">#</a> Add an assertion</h4> <p>Adding a lookbehind, <code>\b</code>, or <code>^</code> assertion at the start of the pattern can solve a lot of issues.</p> <p>This fix is typically only applicable if the exploitable quantifier can consume exactly one character per iteration. Quantifiers that can consume more than character per iteration (e.g. <code>(?:abc)+</code>, <code>(?:ab?)+</code>) are very difficult to fix with this approach.</p> <p>Example: <code>/[a-z_][a-z_0-9]*(?=\s*\()/i</code></p> <p>This is a simple regex to find the names of functions and function-like macros in a C program.</p> <p>This rule says that the first <code>[a-z_0-9]*</code> causes quadratic runtime for &quot;any attack string <code>/[A-Z_]+/i</code>.&quot;</p> <p>The problem is that <code>[a-z_][a-z_0-9]*</code> isn't guaranteed to start at the start of the function name, the <code>[a-z_]</code> can also match anywhere inside the function name.</p> <p>The fix is to add an assertion to make sure that <code>[a-z_]</code> matches the first character of a name. We can use the lookbehind <code>(?&lt;![a-z_0-9])</code> == <code>(?&lt;!\w)</code>. In this case, it's also possible to use the built-in <code>\b</code> assertion.</p> <p>Note that using <code>(?&lt;![a-z_])</code> is not enough. <code>(?&lt;![a-z_])[a-z_]</code> can still match in the middle of the name for names with numbers (e.g. <code>str2int</code>). The lookbehind has to disallow the characters of the quantifier <code>[a-z_0-9]*</code>.</p> <div class="eslint-editor-root eslint-code-block eslint-editor-dark" style="height:;" data-v-0bd0b1ae><div class="eslint-editor-swap-container"><code class="eslint-editor-placeholder-code"></code> <div class="eslint-editor-placeholder-loading"><div class="eslint-editor-placeholder-loading-icon"><div></div> <div></div> <div></div></div> <div class="eslint-editor-placeholder-loading-message">
                        Now loading...
                    </div></div></div></div> <h3 id="limitations-of-this-rule"><a href="#limitations-of-this-rule" class="header-anchor">#</a> Limitations of this rule</h3> <p>This rule implements a simple detection method. It is unable to find certain cases.</p> <p>This means that this rule might not be able to verify fixed regexes. This rule might be unable to detect that supposedly fixed regexes are actually still vulnerable.</p> <h2 id="options"><a href="#options" class="header-anchor">#</a> 🔧 Options</h2> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;regexp/no-super-linear-move&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;report&quot;</span><span class="token operator">:</span> <span class="token string">&quot;certain&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;ignoreSticky&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="report-certain-potential"><a href="#report-certain-potential" class="header-anchor">#</a> <code>report: &quot;certain&quot; | &quot;potential&quot;</code></h3> <p>This option has the same function as the <a href="/eslint-plugin-regexp/rules/no-super-linear-backtracking.html#report"><code>report</code> option of <code>regexp/no-super-linear-backtracking</code></a>. The default value is <code>&quot;certain&quot;</code>.</p> <h3 id="ignoresticky-boolean"><a href="#ignoresticky-boolean" class="header-anchor">#</a> <code>ignoreSticky: boolean</code></h3> <p>By default, this rule ignores regexes with the sticky (<code>y</code>) flag. These regexes do not move across the input string on their own and they are mostly immune to this type of super-linear worst-case because of that. However, some algorithms (and even built-in JavaScript functions) manually move regexes across the string and others change the flags of regexes.</p> <p>This option determines whether this rule will ignore regexes with sticky (<code>y</code>) flag.</p> <ul><li><p><code>ignoreSticky: true</code>  (<em>default</em>)</p> <p>Regexes with the sticky (<code>y</code>) flag will be ignored.</p></li> <li><p><code>ignoreSticky: false</code></p> <p>All regexes will be analysed.</p></li></ul> <h3 id="ignorepartial-boolean"><a href="#ignorepartial-boolean" class="header-anchor">#</a> <code>ignorePartial: boolean</code>:</h3> <p>Some regexes are used as fragments to build more complex regexes. Example:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> fn <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\w+(?=\s*\()</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span>source<span class="token punctuation">;</span>
<span class="token keyword">const</span> pattern <span class="token operator">=</span> <span class="token function">RegExp</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">#\\s*define\\s+</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>fn<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token string">&quot;g&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Even if a fragment had exploitable quantifiers, it might not cause super-linear runtime depending on how the fragment is used.</p> <ul><li><p><code>ignorePartial: true</code>  (<em>default</em>)</p> <p>The rule does not check regexes used as a fragment. It assumes that fragments are used in a way such that super-linear runtime caused by moves is prevented.</p></li> <li><p><code>ignorePartial: false</code></p> <p>The rule checks all regexes regardless of how they are used.</p></li></ul> <h2 id="further-reading"><a href="#further-reading" class="header-anchor">#</a> 📚 Further reading</h2> <ul><li><a href="https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS" target="_blank" rel="noopener noreferrer">Regular expression Denial of Service - ReDoS<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/RunDevelopment/scslre" target="_blank" rel="noopener noreferrer">scslre<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="version"><a href="#version" class="header-anchor">#</a> 🚀 Version</h2> <p>This rule was introduced in eslint-plugin-regexp v0.13.0</p> <h2 id="implementation"><a href="#implementation" class="header-anchor">#</a> 🔍 Implementation</h2> <ul><li><a href="https://github.com/ota-meshi/eslint-plugin-regexp/blob/master/lib/rules/no-super-linear-move.ts" target="_blank" rel="noopener noreferrer">Rule source<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/ota-meshi/eslint-plugin-regexp/blob/master/tests/lib/rules/no-super-linear-move.ts" target="_blank" rel="noopener noreferrer">Test source<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/ota-meshi/eslint-plugin-regexp/edit/master/docs/rules/no-super-linear-move.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">7/28/2021, 6:01:26 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/eslint-plugin-regexp/rules/no-super-linear-backtracking.html" class="prev">
        regexp/no-super-linear-backtracking
      </a></span> <span class="next"><a href="/eslint-plugin-regexp/rules/no-useless-assertions.html">
        regexp/no-useless-assertions
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/eslint-plugin-regexp/assets/js/app.53bb6b9c.js" defer></script><script src="/eslint-plugin-regexp/assets/js/7.099bdba0.js" defer></script><script src="/eslint-plugin-regexp/assets/js/47.8b960cb8.js" defer></script><script src="/eslint-plugin-regexp/assets/js/10.252a16cb.js" defer></script>
  </body>
</html>
